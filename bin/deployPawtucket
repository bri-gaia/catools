#!/usr/bin/env bash
set -x
set -e
set -u
SCRIPT_DIR="$( cd "$( dirname "$0" )" && pwd -P)"
ln -sf vendor/collectiveaccess/pawtucket2 $PAWTUCKET_HOME
ln -sf $APP_ROOT/setup.php.pawtucket $PAWTUCKET_HOME/setup.php
[ -d $APP_ROOT/pawtucket-theme ] && ln -sf $APP_ROOT/pawtucket-theme/* $PAWTUCKET_HOME/themes/$PAWTUCKET_THEME
pushd $PAWTUCKET_HOME
composer install
rm -rf media
rm -rf app/log
ln -sf $APP_ROOT/media .
ln -sf $APP_ROOT/log app/
ln -sf $SCRIPT_DIR/app/lib/core/Auth/Adapters/FlindersOkta.php "${PAWTUCKET_HOME}/app/lib/core/Auth/Adapters/FlindersOkta.php"
# override the default templates to prevent duplicate menu items
ln -sf $SCRIPT_DIR/app/printTemplates/results/* "${PAWTUCKET_HOME}/app/printTemplates/results/"
# copy the en_US to en_AU
ln -sf "${PAWTUCKET_HOME}/app/locale/en_GB" "${PAWTUCKET_HOME}/app/locale/en_AU"
popd

